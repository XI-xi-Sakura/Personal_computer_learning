# 网络基础

## 计算机网络背景



- **独立模式**:计算机之间相互独立
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f324418b86374ecb8ba3e613cd1e7c91.png)
- **网络互联**:多台计算机连接在一起,完成数据共享
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/75fdde0ac24742fca108356495249778.png)
- **局域网LAN**:计算机数量更多了,通过交换机和路由器连接在一起
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b4b57793f48443dbb061fa9a81802a8f.png)
- **广域网WAN**:将远隔千里的计算机都连在一起
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/ac39ee89c1c34154a1e26eeee6b359d0.png)
所谓"局域网"和"广域网"只是一个相对的概念.比如,我们有"天朝特色"的广域网,也可以看做一个比较大的局域网

## 初识协议

- **"协议"是一种约定.**
- 打电话约定电话铃响的次数的约定
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/24548858449f405f9f20bea2bea4df09.png)

计算机之间的传输媒介是光信号和电信号.通过"频率"和"强弱"来表示0和1这样的信息.要想传递各种不同的信息,就需要约定好双方的数据格式.

思考:只要通信的两台主机,约定好协议就可以了么?

 >定好协议，但是你用频率表示01，我用强弱表示01，就好比我用中国话，你用葡萄牙语一样，虽然大家可能遵守的一套通信规则，但是语言不同，即是订好了基本的协议，也是无法正常通信的

所以，完善的协议，需要更多更细致的规定，并让参与的人都要遵守。
- 计算机生产厂商有很多;
- 计算机操作系统,也有很多
- 计算机网络硬件设备,还是有很多;

如何让这些不同厂商之间生产的计算机能够相互顺畅的通信?就需要有人站出来, 约定一个共同的标准,大家都来遵守,这就是**网络协议**;


协议分层
- 协议本质也是软件，在设计上为了更好的进行模块化，解耦合，也是被设计成为**层状结构**的.
- 软件分层的好处:分层可以实现**解耦合**，让软件维护的成本更低（分层是解耦合的有效方式）
> - 小白视角来看，同层协议直接通信
> - 工程师角度：同层协议，没有直接通信，而是各自使用下层提供的结构能力实现的函数

## OSI 七层模型

- OSI（OpenSystemInterconnection，开放系统互连）七层网络模型，称为开放式系统互联参考模型，是一个逻辑上的定义和规范;
- 把网络从逻辑上分为了7层.每一层都有相关、相对应的物理设备，比如路由器，交换机;
 - OSI七层模型是一种框架性的设计方法，其最主要的功能使就是帮助不同类型的主机实现数据传输;
 - 它的最大优点是**将服务、接口和协议这三个概念明确地区分开来**，概念清楚，理论也比较完整.通过七个层次化的结构模型使不同的系统不同的网络之间实现可靠的通讯;
 - 但是,它既复杂又不实用;所以我们按照**TCP/IP四层模型**来讲解
  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/9f1d323ea0d647ff97804ffd29d45c5d.png)


- 其实在网络角度，OSI定的协议7层模型其实非常完善，但是在实际操作的过程中，会话层、表示层是不可能接入到操作系统中的，所以在工程实践中，最终落地的是5层协议。

>应用层：数据处理业务
>表示层：自定义协议并添加相应报头
>IO基本层

## TCP/IP 五层(或四层)模型

TCP/IP是**一组协议**的代名词，它还包括许多协议，组成了TCP/IP协议簇.

 TCP/IP通讯协议采用了5层的层级结构，**每一层都呼叫它的下一层所提供的网络来完成自己的需求**.
 
 - 物理层:**负责光/电信号的传递方式**.
 	- 比如现在以太网通用的网线(双绞线)、早期以太网采用的的同轴电缆(现在主要用于有线电视)、光纤,现在的wifi无线网使用电磁波等都属于物理层的概念。
 	- 物理层的能力决定了最大传输速率、传输距离、抗干扰性等.
 	- 集线器(Hub)工作在物理层.
 - 数据链路层:负责设备之间的数据帧的传送和识别.例如网卡设备的驱动、帧同步(从网线上检测到什么信号算作新帧的开始)、冲突检测(如果检测到冲突就自动重发)、数据差错校验等工作.
 	- 有以太网、令牌环网,无线LAN等标准.交换机(Switch)工作在数据链路层.
- 网络层:**负责地址管理和路由选择**.
	- 例如在IP协议中,通过IP地址来标识一台主机,并通过路由表的方式规划出两台主机之间的数据传输的线路(路由).
	- 路由器(Router)工作在网路层.
- 传输层:负责两台主机之间的数据传输.如传输控制协议(TCP),能够确保数据可靠的从源主机发送到目标主机.
- 应用层:负责应用程序间沟通，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远程访问协议（Telnet）等.
	- 我们的网络编程主要就是针对应用层.

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/06ade51abacb4a2fbe9c48788c9db8af.png)
物理层我们考虑的比较少，我们只考虑软件相关的内容.因此很多时候我们直接称为TCP/IP四层模型.


一般而言：
 - 对于一台主机,它的操作系统内核实现了从传输层到物理层的内容;
 - 对于一台路由器,它实现了从网络层到物理层;
 - 对于一台交换机,它实现了从数据链路层到物理层;
 - 对于集线器,它只实现了物理层;

但是并不绝对.很多交换机也实现了网络层的转发;很多路由器也实现了部分传输层的内容(比如端口转发)



## 协议详解

### 为什么要有TCP/IP协议？

首先，即便是单机，你的计算机内部，其实都是存在协议的，

比如：其他设备和内存通信，会有内存协议。其他设备和磁盘通信，会有磁盘相关的协议，比如：SATA，IDE，SCSI等。只不过我们感知不到罢了。

而且这些协议都在本地主机各自的硬件中，通信的成本、问题比较少。

其次，**网络通信最大的特点就是主机之间变远了**。任何通信特征的变化，一定会带来新的问题，有问题就得解决问题，所以需要新的协议。

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8b4ce87a11874fb8a5452355b3d3ab11.png)

### 什么是TCP/IP协议？

- `TCP/IP`协议的本质是一种解决方案
- `TCP/IP`协议能分层，前提是因为**问题们本身能分层**。

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/6032fc468a564989a0223291c08634ec.png)
- 传输层最著名的协议为TCP协议
- 网络层最著名的协议为IP协议

### 所以究竟什么是协议？

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/182457518a8d4a018367f8da7cf6de6f.png)
问题：主机B能识别data，并且准确提取a=10，b=20，c=30吗？
回答：答案是肯定的！因为双方都有同样的结构体类型structprotocol。也就是说，**用同样的代码实现协议，用同样的自定义数据类型**，天然就具有”共识“，能够识别对方发来的数据，这不就是约定吗？

关于协议的朴素理解：所谓协议，就是**通信双方都认识的结构化的数据类型**

因为协议栈是分层的，所以，每层都有双方都有协议，同层之间，互相可以认识对方的协议。



